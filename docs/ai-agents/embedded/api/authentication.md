---
products: embedded
---

# Authentication

The Airbyte Embedded API uses multiple token types to support different use cases and security requirements. Understanding which token to use is critical for proper integration.

## Token Types Overview

| Token Type | Use Case | Scope | Lifetime | Generated By |
|------------|----------|-------|----------|--------------|
| **Access Token** | Operator/backend operations | Organization | Per session | Airbyte Cloud dashboard |
| **Scoped Token** | End-user API operations | Single workspace | Per session | Your backend via API |
| **Widget Token** | Embedded widget integration | Single workspace | Per session | Your backend via API |
| **Instance Admin Token** | Platform administration | Global | Per session | Airbyte (internal use) |

## Access Token (Operator Token)

Access Tokens are the primary authentication method for your backend services to manage Airbyte Embedded configurations.

### When to Use
- Creating and managing source templates
- Creating and managing connection templates
- Managing workspaces
- Generating tokens for end users
- Any organizational-level operations

### Requirements
- User must be an **Organization Admin** in Airbyte Cloud
- Organization must have Embedded features enabled

### How to Obtain
1. Log in to [Airbyte Cloud](https://cloud.airbyte.com)
2. Navigate to **Settings ’ Applications**
3. Create or copy your **Client ID** and **Client Secret**
4. Use the Airbyte authentication API to exchange credentials for a bearer token

### Usage Example

```bash
# Request
curl -X POST https://api.airbyte.com/v1/oauth/token \
  -H "Content-Type: application/json" \
  -d '{
    "grant_type": "client_credentials",
    "client_id": "your-client-id",
    "client_secret": "your-client-secret"
  }'

# Response
{
  "access_token": "eyJhbGciOiJIUzI1NiIs...",
  "token_type": "Bearer",
  "expires_in": 3600
}
```

```bash
# Use the access token in API requests
curl -X GET https://api.airbyte.ai/api/v1/integrations/templates/sources \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIs..." \
  -H "X-Organization-Id: your-org-id"
```

### Multi-Organization Users

If your user belongs to multiple organizations, you must specify which organization you're operating on using the `X-Organization-Id` header:

```bash
curl -X GET https://api.airbyte.ai/api/v1/integrations/templates/sources \
  -H "Authorization: Bearer your-access-token" \
  -H "X-Organization-Id: 123e4567-e89b-12d3-a456-426614174000"
```

Without this header, requests from multi-organization users will fail with a 400 error.

## Scoped Token

Scoped Tokens provide workspace-level access for end-user operations. Use these tokens when your end users need to interact with Airbyte APIs directly.

### When to Use
- End-user source configuration via API (not widget)
- Listing source templates available to an end user
- Managing sources within a specific workspace
- Any operation that should be isolated to a single end user's workspace

### How to Generate

Your backend should generate scoped tokens on behalf of your end users:

```bash
POST /api/v1/embedded/scoped-token
Authorization: Bearer {your-access-token}
Content-Type: application/json

{
  "workspace_name": "user-123-workspace",
  "region_id": "us-west-2"  // Optional: defaults to US region
}
```

**Response:**
```json
{
  "token": "scoped-eyJhbGciOiJIUzI1NiIs..."
}
```

### Workspace Creation Behavior

When you request a scoped token:
1. The API searches for an existing workspace with the given `workspace_name` in your organization
2. If found, a token for that workspace is returned
3. If not found, a new workspace is created automatically with that name
4. The workspace is created in the specified `region_id` (or default US region if not specified)

### Usage Example

Once you have a scoped token, pass it to your end user's client application:

```javascript
// Your end user's client makes API calls with the scoped token
fetch('https://api.airbyte.ai/api/v1/embedded/sources', {
  method: 'GET',
  headers: {
    'Authorization': `Bearer ${scopedToken}`,
    'Content-Type': 'application/json'
  }
})
```

### Security Considerations

- Scoped tokens should only be shared with the specific end user they were created for
- Store scoped tokens securely in your application (e.g., secure HTTP-only cookies, encrypted storage)
- Scoped tokens have workspace-level permissions - users can manage all sources within their workspace
- Never expose your Access Token to end users - only share Scoped Tokens

### Getting Scoped Token Information

To retrieve metadata about a scoped token (such as the organization and workspace it's scoped to):

```bash
GET /api/v1/embedded/scoped-token/info
Authorization: Bearer {scoped-token}
```

**Response:**
```json
{
  "organization_id": "123e4567-e89b-12d3-a456-426614174000",
  "workspace_id": "789e0123-e45b-67c8-d901-234567890abc"
}
```

## Widget Token

Widget Tokens are specialized tokens for embedding the Airbyte widget in your application. They combine a scoped token with widget configuration.

### When to Use
- Embedding the Airbyte widget iframe in your web application
- When you want end users to configure sources through the Airbyte UI rather than building your own
- Quick integration without building custom source configuration forms

### How to Generate

```bash
POST /api/v1/embedded/widget-token
Authorization: Bearer {your-access-token}
Content-Type: application/json

{
  "workspace_name": "user-123-workspace",
  "allowed_origin": "https://your-app.com",
  "region_id": "us-west-2",  // Optional
  "selected_source_template_tags": ["crm", "marketing"],  // Optional
  "selected_source_template_tags_mode": "any",  // "any" or "all"
  "selected_connection_template_tags": ["data-warehouse"],  // Optional
  "selected_connection_template_tags_mode": "all"  // "any" or "all"
}
```

### Request Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `workspace_name` | string | Yes | Unique identifier for the end user's workspace |
| `allowed_origin` | string | Yes | Your application's origin for CORS (e.g., `https://your-app.com`) |
| `region_id` | string | No | AWS region for workspace (defaults to US) |
| `selected_source_template_tags` | array | No | Filter source templates by tags |
| `selected_source_template_tags_mode` | enum | No | Tag matching mode: `"any"` (OR) or `"all"` (AND) |
| `selected_connection_template_tags` | array | No | Filter connection templates by tags |
| `selected_connection_template_tags_mode` | enum | No | Tag matching mode: `"any"` (OR) or `"all"` (AND) |

### Response Format

```json
{
  "token": "base64-encoded-widget-token"
}
```

The widget token is a **base64-encoded JSON object** containing:
- The scoped token for authentication
- The complete widget URL with all configuration parameters

### Decoding the Widget Token (For Reference)

```javascript
// Decode the widget token (for understanding - you typically don't need to do this)
const decoded = JSON.parse(atob(widgetToken));
console.log(decoded);
// Output:
// {
//   "token": "scoped-token-here",
//   "widgetUrl": "https://app.airbyte.com/widget?workspaceId=...&allowedOrigin=..."
// }
```

### Using the Widget Token

Pass the entire widget token to the Airbyte widget component:

```html
<iframe
  src="https://app.airbyte.com/widget"
  data-airbyte-token="base64-encoded-widget-token"
  width="100%"
  height="600px"
></iframe>
```

Or with the Airbyte widget library:

```javascript
import { AirbyteWidget } from '@airbyte-embedded/airbyte-embedded-widget';

<AirbyteWidget token={widgetToken} />
```

See the [Widget Integration Guide](../widget/integration-guide.md) for complete widget usage documentation.

### Tag Filtering

Use tags to control which source and connection templates are available in the widget:

**Example: Show only CRM and Marketing sources**
```json
{
  "workspace_name": "user-123-workspace",
  "allowed_origin": "https://your-app.com",
  "selected_source_template_tags": ["crm", "marketing"],
  "selected_source_template_tags_mode": "any"  // Show templates with crm OR marketing tag
}
```

**Example: Show only sources tagged with both "paid" and "verified"**
```json
{
  "workspace_name": "user-123-workspace",
  "allowed_origin": "https://your-app.com",
  "selected_source_template_tags": ["paid", "verified"],
  "selected_source_template_tags_mode": "all"  // Show only templates with BOTH tags
}
```

## Authentication Headers

### Required Headers

All API requests require the `Authorization` header:

```
Authorization: Bearer {token}
```

### Optional Headers

#### X-Organization-Id

Required when your user belongs to multiple organizations:

```
X-Organization-Id: 123e4567-e89b-12d3-a456-426614174000
```

This header is optional if your user only belongs to one organization, but recommended for clarity.

## Token Permissions Matrix

| Operation | Access Token | Scoped Token | Widget Token |
|-----------|--------------|--------------|--------------|
| Create source templates |  Yes | L No | L No |
| Create connection templates |  Yes | L No | L No |
| List source templates |  Yes |  Yes |  Yes (via widget) |
| Create end-user sources |  Yes |  Yes |  Yes (via widget) |
| Update end-user sources |  Yes |  Yes |  Yes (via widget) |
| Delete end-user sources |  Yes |  Yes |  Yes (via widget) |
| Manage workspaces |  Yes | L No | L No |
| Generate tokens for users |  Yes | L No | L No |
| Cross-workspace operations |  Yes | L No | L No |

## Token Security Best Practices

### Access Tokens
- Store securely on your backend (environment variables, secret manager)
- Never expose to client-side code
- Never commit to version control
- Rotate periodically
- Use separate tokens for dev/staging/production

### Scoped Tokens
- Generate fresh tokens for each user session
- Transmit over HTTPS only
- Store in secure client-side storage (HTTP-only cookies preferred)
- Implement token refresh when expired
- Consider short expiration times for sensitive data

### Widget Tokens
- Generate on-demand when embedding the widget
- Use short-lived tokens when possible
- Validate `allowed_origin` matches your application's domain
- Monitor widget usage for anomalies

## Error Responses

### 401 Unauthorized

Token is invalid, expired, or missing:

```json
{
  "error": "Unauthorized",
  "message": "Invalid bearer token"
}
```

**Solution:** Obtain a new token and retry.

### 403 Forbidden

Token is valid but lacks required permissions:

```json
{
  "error": "Forbidden",
  "message": "User must be an organization admin"
}
```

**Solution:** Ensure the user has appropriate permissions in Airbyte Cloud.

### 400 Bad Request (Multi-Organization)

Multi-organization user without `X-Organization-Id` header:

```json
{
  "error": "Bad Request",
  "message": "User associated with multiple organizations, specify target organization with header: X-Organization-Id"
}
```

**Solution:** Add the `X-Organization-Id` header to your request.

## Regional Considerations

When generating scoped or widget tokens, you can optionally specify a `region_id` to control where the workspace is created:

**Supported Regions:**
- `us-east-1` (US East)
- `us-west-2` (US West) - Default
- `eu-west-1` (EU Ireland)

**Example:**
```json
{
  "workspace_name": "eu-user-workspace",
  "allowed_origin": "https://your-app.com",
  "region_id": "eu-west-1"
}
```

**Note:** Once a workspace is created in a region, it cannot be moved. Choose the region closest to your end users for optimal performance.

## Next Steps

- [Configure Source Templates](./source-templates.md)
- [Configure Connection Templates](./connection-templates.md)
- [Configure End-User Sources](./configuring-sources.md)
- [Embed the Widget](../widget/integration-guide.md)
- [Manage Workspaces](./workspaces.md)
